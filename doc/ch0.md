# 数据库是如何工作的？

- 数据以什么格式保存？（在内存和磁盘中）
- 它何时从内存移动到磁盘？
- 为什么每个表只能有一个主键？
- 回滚事务是如何工作的？
- 索引是如何格式化的？
- 何时以及如何进行全表扫描？
- 准备好的语句以什么格式保存？

简言之，数据库是如何工作的？

为了理解这一点，我正在用C从头开始构建sqlite的克隆，并且我将记录我的过程。

## 目录

- 第1部分-介绍和设置REPL
- 第2部分-世界上最简单的SQL编译器和虚拟机
- 第3部分-内存中、仅附加、单表数据库
- 第4部分-我们的第一个测试（和bug）
- 第5部分-磁盘持久性
- 第6部分-游标抽象
- 第7部分-B树简介
- 第8部分-B树叶节点格式
- 第9部分-二进制搜索和重复键
- 第10部分-拆分叶节点
- 第11部分-递归搜索B树
- 第12部分-扫描多级B树
- 第13部分-拆分后更新父节点

*“What I cannot create, I do not understand.” – Richard Feynman*

![](/img/sqlite-architecture2.gif)